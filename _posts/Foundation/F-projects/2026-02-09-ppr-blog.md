---
layout: post
title: Personal Project Reference- Citation Generator
permalink: /ppr
comments: true
---

# Personal Project Reference (PPR)
## AP Computer Science Principles - Media Literacy Citation Generator

---

## Project Overview

This citation generator helps students create properly formatted academic citations in APA, MLA, and Chicago styles while managing a collection of saved references. The program demonstrates data abstraction through list processing and includes algorithms for filtering, sorting, and quality-checking citations.

---

## COMPONENT A: PROGRAM CODE

### Code Segment 1: Student-Developed Procedure with Algorithm

**Purpose:** This procedure processes and filters a collection of citations based on style and maximum items, demonstrating sequencing, selection, and iteration.

**Key Features:**
- **Parameters:** Takes `citationList` (array), `filterStyle` (string), and `maxItems` (number)
- **Return type:** Returns an object containing filtered citations and statistics  
- **Algorithm elements:** Includes sequencing (ordered steps), selection (conditional logic), and iteration (loops)
- **Data abstraction:** Works with a list/collection of citation objects
- **Manages complexity:** Encapsulates complex filtering logic in a reusable function

```javascript
function processCitationList(citationList, filterStyle, maxItems) {
    let filtered = [];
    let styleCount = { apa: 0, mla: 0, chicago: 0 };
    
    for (let i = 0; i < citationList.length; i++) {
        let citation = citationList[i];
        
        if (filterStyle === 'all' || citation.style === filterStyle) {
            filtered.push(citation);
        }
        
        if (citation.style && styleCount.hasOwnProperty(citation.style)) {
            styleCount[citation.style]++;
        }
        
        if (filtered.length >= maxItems) {
            break;
        }
    }
    
    return {
        citations: filtered,
        totalCount: citationList.length,
        styleCounts: styleCount
    };
}
```

---

### Code Segment 2: List Data Structure - Storing Citations

**Purpose:** This code demonstrates how citation data is stored in a list (array) structure using localStorage, showing data abstraction at work.

**Key Features:**
- **Input collection:** Gathers user form data into a payload object
- **List manipulation:** Retrieves existing array from storage, adds new item, saves back
- **Data abstraction:** The list manages multiple citation objects, each with multiple properties
- **Managing complexity:** The collection allows the program to handle many citations efficiently

```javascript
function saveToWorksCited() {
    const citation = generate();
    if (!citation || citation.length < 5) {
        alert('Please generate a citation first.');
        return;
    }
    
    const payload = {
        author: safe(authorEl.value),
        date: safe(dateEl.value),
        title: safe(titleEl.value),
        source: safe(sourceEl.value),
        url: safe(urlEl.value)
    };
    
    const style = styleEl.value;
    const parenthetical = buildParenthetical({ ...payload, style });
    
    const saved = JSON.parse(localStorage.getItem(KEY) || '[]');
    
    const newCitation = { 
        citation, 
        style: styleEl.value,
        at: Date.now(),
        source: safe(sourceEl.value),
        title: safe(titleEl.value),
        url: safe(urlEl.value),
        author: safe(authorEl.value),
        date: safe(dateEl.value),
        parenthetical: parenthetical
    };
    
    saved.push(newCitation);
    
    localStorage.setItem(KEY, JSON.stringify(saved));
    alert('✓ Citation saved to References!');
    
    loadWorksCited();
    updateNotesSourceSelect();
}
```

---

### Code Segment 3: Using List Data - Processing and Display

**Purpose:** This code retrieves the citation list and processes it to display organized references by style, demonstrating how the list abstraction manages program complexity.

**Key Features:**
- **List retrieval:** Gets the stored array from localStorage
- **Data organization:** Groups citations by style (APA, MLA, Chicago) using nested loops
- **Iteration:** Processes each citation in the list with `forEach` loops
- **Managing complexity:** The list structure allows organized display of many citations without tracking individual variables

```javascript
async function loadWorksCited() {
    const saved = JSON.parse(localStorage.getItem(KEY) || '[]');
    
    if (saved.length === 0) {
        worksCitedSection.style.display = 'none';
        return;
    }

    worksCitedSection.style.display = 'block';
    worksCitedByStyle.innerHTML = '';

    const byStyle = {
        apa: [],
        mla: [],
        chicago: []
    };

    saved.forEach((item, index) => {
        if (byStyle[item.style]) {
            byStyle[item.style].push({ item, index });
        }
    });

    const styleLabels = {
        apa: 'APA',
        mla: 'MLA (9th ed.)',
        chicago: 'Chicago (author-date)'
    };

    ['apa', 'mla', 'chicago'].forEach(style => {
        if (byStyle[style].length > 0) {
            const groupDiv = document.createElement('div');
            groupDiv.className = 'style-group';
            
            const headerDiv = document.createElement('div');
            headerDiv.className = 'style-group-header';
            headerDiv.textContent = `${styleLabels[style]} (${byStyle[style].length})`;
            groupDiv.appendChild(headerDiv);

            const listDiv = document.createElement('div');
            listDiv.className = 'works-cited-list';

            byStyle[style].forEach(async ({ item, index }) => {
                const citationDiv = document.createElement('div');
                citationDiv.className = 'citation-item';
                
                const textDiv = document.createElement('div');
                textDiv.className = 'citation-text';
                textDiv.innerHTML = item.citation;
                
                const actionsDiv = document.createElement('div');
                actionsDiv.className = 'citation-actions';
                
                const deleteBtn = document.createElement('button');
                deleteBtn.className = 'citation-delete';
                deleteBtn.innerHTML = '×';
                deleteBtn.title = 'Delete this citation';
                deleteBtn.onclick = () => deleteCitation(index);
                
                actionsDiv.appendChild(deleteBtn);
                citationDiv.appendChild(textDiv);
                citationDiv.appendChild(actionsDiv);
                listDiv.appendChild(citationDiv);
            });

            groupDiv.appendChild(listDiv);
            worksCitedByStyle.appendChild(groupDiv);
        }
    });
}
```

---

### Code Segment 4: Input Processing - User Form Data

**Purpose:** This code demonstrates input collection from user interface elements (form fields).

**Key Features:**
- **Input collection:** Gathers data from multiple HTML form fields
- **Validation:** Checks for missing required fields and highlights them
- **Selection:** Uses conditional logic to choose formatting function based on citation style
- **Visual output:** Displays formatted citation and shows warnings for missing information

```javascript
function generate() {
    const payload = {
        author: safe(authorEl.value),
        date: safe(dateEl.value),
        title: safe(titleEl.value),
        source: safe(sourceEl.value),
        url: safe(urlEl.value)
    };

    const missing = [];
    const fields = [
        { el: authorEl, key: 'author', label: 'Author' },
        { el: titleEl, key: 'title', label: 'Title' },
        { el: sourceEl, key: 'source', label: 'Source / Website' },
        { el: dateEl, key: 'date', label: 'Publication Date' }
    ];

    fields.forEach(f => f.el.classList.remove('missing'));

    fields.forEach(f => {
        if (!payload[f.key]) {
            missing.push(f.label);
            f.el.classList.add('missing');
        }
    });

    const style = styleEl.value;
    let citation = '';
    if (style === 'mla') citation = fmtMLA9(payload);
    else if (style === 'chicago') citation = fmtChicago(payload);
    else citation = fmtAPA(payload);

    outTextEl.innerHTML = citation;

    const parentheticalEl = document.getElementById('cite-parenthetical');
    const parenthetical = buildParenthetical({ ...payload, style });

    if (parentheticalEl) {
        parentheticalEl.innerHTML = parenthetical
            ? `<span class="citation-output-label">Parenthetical Citation:</span>${parenthetical}`
            : '';
    }

    const warningEl = document.getElementById('cite-warning');
    if (missing.length > 0) {
        warningEl.innerHTML =
            `⚠️ Missing citation info: <b>${missing.join(', ')}</b><br>
             Please manually enter these fields for a complete citation.`;
        warningEl.style.display = 'block';
    } else {
        warningEl.style.display = 'none';
    }

    return citation;
}
```

---

### Code Segment 5: Output - Tactile Clipboard Interaction

**Purpose:** This code demonstrates tactile output by copying text to the user's clipboard, providing direct user interaction.

**Key Features:**
- **Output delivery:** Uses the modern Clipboard API to copy text
- **Fallback method:** Provides alternative copy method for browsers that don't support Clipboard API
- **User feedback:** Shows alert messages to confirm successful copy operation
- **Error handling:** Catches failures and attempts fallback method

```javascript
function copyToClipboard(text) {
    const tempDiv = document.createElement('div');
    tempDiv.innerHTML = text;
    const plainText = tempDiv.textContent || tempDiv.innerText || '';

    if (navigator.clipboard && navigator.clipboard.writeText) {
        navigator.clipboard.writeText(plainText).then(() => {
            alert('✓ Citation copied to clipboard!');
        }).catch(() => { 
            fallbackCopy(plainText);
        });
    } else {
        fallbackCopy(plainText);
    }
}

function fallbackCopy(text) {
    const ta = document.createElement('textarea');
    ta.value = text;
    ta.style.position = 'fixed';
    ta.style.opacity = '0';
    document.body.appendChild(ta);
    ta.select();
    try { 
        document.execCommand('copy');
        alert('✓ Citation copied to clipboard!');
    } catch (e) {
        alert('Copy failed. Please manually copy the citation.');
    }
    ta.remove();
}
```

---

### Code Segment 6: Backend API - Citation Quality Check

**Purpose:** This backend procedure checks citation quality using multiple algorithms, demonstrating server-side processing with Python/Flask.

**Key Features:**
- **Parameters:** Takes `url`, `author`, `date`, `source`, and `fetch_page` as inputs
- **Return type:** Returns a dictionary with score and detailed analysis
- **Algorithm elements:** Uses sequencing (ordered checks), selection (conditional scoring), and iteration (processing through quality criteria)
- **Procedure calls:** Calls helper function `check_author_credentials` to evaluate author information

```python
def check_citation_quality_enhanced(url, author, date, source, fetch_page=False):
    score = 5
    reasons = []
    
    try:
        parsed = urlparse(url)
        domain = parsed.netloc.lower().replace('www.', '')
        
        if domain in CREDIBLE_DOMAINS:
            score = CREDIBLE_DOMAINS[domain]
            reasons.append(f"Known credible source ({CREDIBLE_DOMAINS[domain]}/10 base)")
        elif domain in QUESTIONABLE_DOMAINS:
            score = QUESTIONABLE_DOMAINS[domain]
            reasons.append(f"Known questionable source ({QUESTIONABLE_DOMAINS[domain]}/10 base)")
        else:
            reasons.append("Unknown domain (5/10 base)")
        
        if domain.endswith(('.edu', '.ac.uk', '.edu.au')):
            adj = +2
            score += adj
            reasons.append(f"Educational institution (+{adj})")
        elif domain.endswith(('.gov', '.gov.uk')):
            adj = +2
            score += adj
            reasons.append(f"Government source (+{adj})")
        
        if parsed.scheme == 'https':
            adj = +1
            score += adj
            reasons.append(f"Secure connection (+{adj})")
        
        author_adj = check_author_credentials(author, url)
        if author_adj != 0:
            score += author_adj
            if author_adj > 0:
                reasons.append(f"Author credentials (+{author_adj})")
            else:
                reasons.append(f"No author listed ({author_adj})")
        
        final_score = min(max(score, 1), 10)
        
        return {
            'score': final_score,
            'reasons': reasons,
            'raw_score': score
        }
        
    except Exception as e:
        print(f"Error in quality check: {e}")
        return {
            'score': 5,
            'reasons': ['Error during analysis'],
            'raw_score': 5
        }
```

---

## COMPONENT C: PERSONALIZED PROJECT REFERENCE

### Section 1: PROCEDURE

#### i. Student-Developed Procedure Definition

This procedure filters and processes a list of citations. It demonstrates an algorithm with **sequencing** (ordered variable initialization), **selection** (conditional filtering with if-statements), and **iteration** (for-loop through the citation list). The procedure takes three parameters and returns a structured object with filtered results.

```javascript
function processCitationList(citationList, filterStyle, maxItems) {
    let filtered = [];
    let styleCount = { apa: 0, mla: 0, chicago: 0 };
    
    for (let i = 0; i < citationList.length; i++) {
        let citation = citationList[i];
        
        if (filterStyle === 'all' || citation.style === filterStyle) {
            filtered.push(citation);
        }
        
        if (citation.style && styleCount.hasOwnProperty(citation.style)) {
            styleCount[citation.style]++;
        }
        
        if (filtered.length >= maxItems) {
            break;
        }
    }
    
    return {
        citations: filtered,
        totalCount: citationList.length,
        styleCounts: styleCount
    };
}
```

#### ii. Procedure Call

This shows the `processCitationList` procedure being called with actual parameters: the saved citations array, the filter string `'all'`, and max items of `50`. The returned result object is then used to organize and display the citations by style.

```javascript
async function loadWorksCited() {
    const saved = JSON.parse(localStorage.getItem(KEY) || '[]');
    
    if (saved.length === 0) {
        worksCitedSection.style.display = 'none';
        return;
    }

    const result = processCitationList(saved, 'all', 50);
    
    worksCitedSection.style.display = 'block';
    worksCitedByStyle.innerHTML = '';

    const byStyle = {
        apa: [],
        mla: [],
        chicago: []
    };

    result.citations.forEach((citation, index) => {
        if (byStyle[citation.style]) {
            byStyle[citation.style].push({ item: citation, index });
        }
    });
}
```

---

### Section 2: LIST

#### i. Storing Data in List

This code demonstrates **storing a citation object into a list** (array). The list is retrieved from localStorage as a JSON array, a new citation object is created with all necessary properties, and then added to the array using the `push()` method. The updated list is saved back to storage, demonstrating how the list manages multiple citation objects.

```javascript
function saveToWorksCited() {
    const citation = generate();
    const payload = {
        author: safe(authorEl.value),
        date: safe(dateEl.value),
        title: safe(titleEl.value),
        source: safe(sourceEl.value),
        url: safe(urlEl.value)
    };
    
    const style = styleEl.value;
    const parenthetical = buildParenthetical({ ...payload, style });
    
    const saved = JSON.parse(localStorage.getItem(KEY) || '[]');
    
    const newCitation = { 
        citation, 
        style: styleEl.value,
        at: Date.now(),
        source: safe(sourceEl.value),
        title: safe(titleEl.value),
        url: safe(urlEl.value),
        author: safe(authorEl.value),
        date: safe(dateEl.value),
        parenthetical: parenthetical
    };
    
    saved.push(newCitation);
    localStorage.setItem(KEY, JSON.stringify(saved));
}
```

#### ii. Using Data from List

This code demonstrates **accessing and processing data from the list**. It retrieves the saved citations array, then uses `forEach` to iterate through each item. The citations are grouped by style (apa, mla, chicago), and then each group is processed to create display elements. This shows how the list abstraction allows efficient organization and display of multiple citations.

```javascript
async function loadWorksCited() {
    const saved = JSON.parse(localStorage.getItem(KEY) || '[]');

    const byStyle = {
        apa: [],
        mla: [],
        chicago: []
    };

    saved.forEach((item, index) => {
        if (byStyle[item.style]) {
            byStyle[item.style].push({ item, index });
        }
    });

    ['apa', 'mla', 'chicago'].forEach(style => {
        if (byStyle[style].length > 0) {
            byStyle[style].forEach(async ({ item, index }) => {
                const citationDiv = document.createElement('div');
                citationDiv.className = 'citation-item';
                
                const textDiv = document.createElement('div');
                textDiv.className = 'citation-text';
                textDiv.innerHTML = item.citation;
                
                const deleteBtn = document.createElement('button');
                deleteBtn.onclick = () => deleteCitation(index);
            });
        }
    });
}
```

---

## Summary Checklist

✅ **Input:** User form data collection through `generate()` function  
✅ **List/Collection:** Array of citation objects stored in localStorage  
✅ **Student-developed procedure:** `processCitationList()` with parameters and return value  
✅ **Algorithm with sequencing, selection, iteration:** `processCitationList()` demonstrates all three  
✅ **Procedure calls:** `processCitationList()` is called in `loadWorksCited()` with actual parameters  
✅ **Output:** Visual display (citations shown on screen), tactile (clipboard copy), audible (alert messages)  
✅ **Data abstraction manages complexity:** The citations list allows handling multiple citation styles and sources efficiently without tracking individual variables for each citation  

**All College Board AP CSP requirements are met in this project.**